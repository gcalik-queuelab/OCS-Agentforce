<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Notify_Account_and_Contract_Owner</name>
        <label>Notify Account Manager and Contract Owner</label>
        <locationX>2457</locationX>
        <locationY>4116</locationY>
        <actionName>Contract__c.AD_760_Contract_Status_Changed_to_At_Risk</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Status_Changed_to_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.AD_760_Contract_Status_Changed_to_At_Risk</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Notify_Account_Team_when_Key_Contact_has_changed</name>
        <label>Notify Account Team when Key Contact has changed</label>
        <locationX>2991</locationX>
        <locationY>3600</locationY>
        <actionName>customNotificationAction</actionName>
        <actionType>customNotificationAction</actionType>
        <connector>
            <targetReference>Status_changed_to_At_Risk</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>customNotifTypeId</name>
            <value>
                <elementReference>Get_Notification_Type.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientIds</name>
            <value>
                <elementReference>Recipients_ID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>title</name>
            <value>
                <stringValue>Key Contact changed on Contract</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>body</name>
            <value>
                <stringValue>The Key Contact has changed. Please go to the record for further details.</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>targetId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>customNotificationAction</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>Notify Contract Owner 180 Days Before Contract End Date</description>
        <name>Notify_Contract_Owner_180_Days_Before_Contract_End_Date</name>
        <label>Notify Contract Owner 180 Days Before Contract End Date</label>
        <locationX>6474</locationX>
        <locationY>600</locationY>
        <actionName>Contract__c.One_Hundred_And_Eighty_days_before_Contract_End_Date</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.One_Hundred_And_Eighty_days_before_Contract_End_Date</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>Notify Contract Owner 30 Days Before Contract End Date</description>
        <name>Notify_Contract_Owner_30_Days_Before_Contract_End_Date</name>
        <label>Notify Contract Owner 30 Days Before Contract End Date</label>
        <locationX>4362</locationX>
        <locationY>600</locationY>
        <actionName>Contract__c.Thirty_days_before_Contract_End_Date</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.Thirty_days_before_Contract_End_Date</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>Notify Contract Owner 90 Days Before</description>
        <name>Notify_Contract_Owner_90_Days_Before_Contract_End_Date</name>
        <label>Notify Contract Owner 90 Days Before Contract End Date</label>
        <locationX>5418</locationX>
        <locationY>600</locationY>
        <actionName>Contract__c.Ninety_days_before_Contract_End_Date</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.Ninety_days_before_Contract_End_Date</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Notify_Contract_Owner_Manager</name>
        <label>Notify Contract Owner Manager</label>
        <locationX>2721</locationX>
        <locationY>4224</locationY>
        <actionName>Contract__c.AD_760_Contract_Status_Changed_to_At_Risk_Manager</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Status_Changed_to_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.AD_760_Contract_Status_Changed_to_At_Risk_Manager</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Catering_New_Contract_Mobilisation_Notification</name>
        <label>Send Catering - New Contract Mobilisation Notification</label>
        <locationX>50</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Catering</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Catering</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Cleaning_New_Contract_Mobilisation_Notification</name>
        <label>Send Cleaning - New Contract Mobilisation Notification</label>
        <locationX>314</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Cleaning</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Cleaning</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Hard_Services_New_Contract_Mobilisation_Notification</name>
        <label>Send Hard Services - New Contract Mobilisation Notification</label>
        <locationX>1634</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Hard_Services_Projects</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Hard_Services_Projects</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Ireland_New_Contract_Mobilisation_Notification</name>
        <label>Send Ireland - New Contract Mobilisation Notification</label>
        <locationX>578</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Ireland</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Ireland</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Private_FM_New_Contract_Mobilisation_Notification</name>
        <label>Send Private FM - New Contract Mobilisation Notification</label>
        <locationX>842</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Private_FM</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Private_FM</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Public_FM_New_Contract_Mobilisation_Notification</name>
        <label>Send Public FM - New Contract Mobilisation Notification</label>
        <locationX>1106</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Public_FM</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Public_FM</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Security_New_Contract_Mobilisation_Notification</name>
        <label>Send Security - New Contract Mobilisation Notification</label>
        <locationX>1370</locationX>
        <locationY>1656</locationY>
        <actionName>Contract__c.UKI_New_Contract_Mobilisation_Security</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Contract__c.UKI_New_Contract_Mobilisation_Security</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>59.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Assign_Account_Team_ID</name>
        <label>Assign Account Team ID</label>
        <locationX>2991</locationX>
        <locationY>3492</locationY>
        <assignmentItems>
            <assignToReference>Recipients_ID</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.Account__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Notify_Account_Team_when_Key_Contact_has_changed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_is_New</name>
        <label>Set is New</label>
        <locationX>3123</locationX>
        <locationY>384</locationY>
        <assignmentItems>
            <assignToReference>v_isNew</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_isNew</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contract_Status_Subflow</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Risk_Status_Amber</name>
        <label>Set Risk Status = Amber</label>
        <locationX>2991</locationX>
        <locationY>3084</locationY>
        <assignmentItems>
            <assignToReference>$Record.Risk_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Amber</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Key_Contact_changed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Risk_Status_Green</name>
        <label>Set Risk Status = Green</label>
        <locationX>3255</locationX>
        <locationY>3084</locationY>
        <assignmentItems>
            <assignToReference>$Record.Risk_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Green</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Key_Contact_changed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Risk_Status_Red</name>
        <label>Set Risk Status = Red</label>
        <locationX>2727</locationX>
        <locationY>3084</locationY>
        <assignmentItems>
            <assignToReference>$Record.Risk_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Red</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Key_Contact_changed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Add the updated Status into the Flow&apos;s Global Record Var so that this reflects the changes made outside of the Flow</description>
        <name>Set_Updated_Status</name>
        <label>Set Updated Status</label>
        <locationX>2991</locationX>
        <locationY>708</locationY>
        <assignmentItems>
            <assignToReference>$Record.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Contract_Status_Subflow.recordId.Status__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_or_Update</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Terminate_Contract</name>
        <label>Terminate Contract</label>
        <locationX>3570</locationX>
        <locationY>1116</locationY>
        <assignmentItems>
            <assignToReference>$Record.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Terminated</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Start_End_Dates_Changed_Decision</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>Have all the CLIs been terminated?</description>
        <name>All_CLIs_Terminated</name>
        <label>All CLIs Terminated?</label>
        <locationX>3702</locationX>
        <locationY>1008</locationY>
        <defaultConnector>
            <targetReference>Start_End_Dates_Changed_Decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Terminate_Contract_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.No_of_Contract_Lines__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>$Record.No_of_Service_Lines_Terminated__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.No_of_Contract_Lines__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Terminate_Contract</targetReference>
            </connector>
            <label>Yes - Terminate Contract</label>
        </rules>
    </decisions>
    <decisions>
        <description>Does the Contract have Commitments?
If so move to mark these as Completed.</description>
        <name>Commitments_Exist_Decision</name>
        <label>Commitments Exist?</label>
        <locationX>2903</locationX>
        <locationY>4776</locationY>
        <defaultConnector>
            <targetReference>Record_Update_Required</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Continue</defaultConnectorLabel>
        <rules>
            <name>Yes_Close_Commitments_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.No_of_In_Progress_Commitments__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.No_of_Overdue_Commitments__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Commitments</targetReference>
            </connector>
            <label>Yes - Close Commitments</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_Owner_Active_180Days</name>
        <label>Contract Owner Active?</label>
        <locationX>6606</locationX>
        <locationY>492</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Owner_Active_180Days</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Notify_Contract_Owner_180_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Yes - Owner Active</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_Owner_Active_30Days</name>
        <label>Contract Owner Active?</label>
        <locationX>4494</locationX>
        <locationY>492</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Owner_Active_30Days</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Notify_Contract_Owner_30_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Yes - Owner Active</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_Owner_Active_90Days</name>
        <label>Contract Owner Active?</label>
        <locationX>5550</locationX>
        <locationY>492</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Owner_Active_90_Days</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Notify_Contract_Owner_90_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Yes - Owner Active</label>
        </rules>
    </decisions>
    <decisions>
        <name>Contract_Owner_Manager_Active_Decision</name>
        <label>Contract Owner Manager Active?</label>
        <locationX>2853</locationX>
        <locationY>4116</locationY>
        <defaultConnector>
            <targetReference>Status_Changed_to_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Contract_Owner_Manager_Active</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contract_Owner_Manager__r.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Notify_Contract_Owner_Manager</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Evaluate current Risk Status field (Colours) and the Total Contract Risk to determine the appropriate colour to set the Risk Status field.</description>
        <name>Contract_Risk_Status_Decision</name>
        <label>Contract Risk Status Decision</label>
        <locationX>3123</locationX>
        <locationY>2976</locationY>
        <defaultConnector>
            <targetReference>Key_Contact_changed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Update Required - Skip</defaultConnectorLabel>
        <rules>
            <name>X25</name>
            <conditionLogic>(1 OR 2) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Total_Contract_Risk__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>25.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Expired</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Risk_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Red</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Risk_Status_Red</targetReference>
            </connector>
            <label>&gt;=25 = Red</label>
        </rules>
        <rules>
            <name>f12to24</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Total_Contract_Risk__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>12.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Total_Contract_Risk__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>24.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Risk_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Amber</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Risk_Status_Amber</targetReference>
            </connector>
            <label>12to24 = Amber</label>
        </rules>
        <rules>
            <name>X11</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Total_Contract_Risk__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>11.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Risk_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Green</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Risk_Status_Green</targetReference>
            </connector>
            <label>&lt;=11 = Green</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the Contract has just been updated to Terminated status (current Status = Terminated but Prior Status != Terminated) then update the Active/Pending Contract Line Items with the Termination Date/Reason.</description>
        <name>Contract_Terminated</name>
        <label>Contract Terminated?</label>
        <locationX>3123</locationX>
        <locationY>2280</locationY>
        <defaultConnector>
            <targetReference>Owner_Changed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Contract_Terminated_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Terminate_CLIs</targetReference>
            </connector>
            <label>Yes - Contract Terminated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Corporate_Type_New_Contract</name>
        <label>Corporate Type</label>
        <locationX>2019</locationX>
        <locationY>1332</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Facilities_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Corporate_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Facilities</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Region_New_Contract</targetReference>
            </connector>
            <label>Facilities</label>
        </rules>
    </decisions>
    <decisions>
        <name>Create_or_Update</name>
        <label>Create or Update?</label>
        <locationX>3123</locationX>
        <locationY>900</locationY>
        <defaultConnector>
            <targetReference>All_CLIs_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Update</defaultConnectorLabel>
        <rules>
            <name>Create</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>v_isNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Related_Opportunity_New_Contract</targetReference>
            </connector>
            <label>Create</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_At_Risk_Notifications</name>
        <label>Emails Enabled? (At Risk Notifications)</label>
        <locationX>2908</locationX>
        <locationY>3900</locationY>
        <defaultConnector>
            <targetReference>Status_Changed_to_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Send_At_Risk_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Contract_Owner_Active</targetReference>
            </connector>
            <label>Yes - Send</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_New_Contract_UK_I_Notification</name>
        <label>Emails Enabled? (New Contract Notification)</label>
        <locationX>2310</locationX>
        <locationY>1224</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Send_New_Contract_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Corporate_Type_New_Contract</targetReference>
            </connector>
            <label>Yes - Continue</label>
        </rules>
    </decisions>
    <decisions>
        <description>Is Contract Owner or Account Owner user records Active?</description>
        <name>Is_Contract_Owner_Active</name>
        <label>Is Contract or Account Owner Active?</label>
        <locationX>2655</locationX>
        <locationY>4008</locationY>
        <defaultConnector>
            <targetReference>Contract_Owner_Manager_Active_Decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Owner_Active</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Account_Owner__r.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Notify_Account_and_Contract_Owner</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Today_180_Days_Before_Contract_End_Date</name>
        <label>Is Today 180 Days Before Contract End Date?</label>
        <locationX>6804</locationX>
        <locationY>384</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_180_Days_Before</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Rolling_Contract__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner_Region__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>APAC</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Pending Termination</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Owner_Active_180Days</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Today_30_Days_Before_Contract_End_Date</name>
        <label>Is Today 30 Days Before Contract End Date?</label>
        <locationX>4692</locationX>
        <locationY>384</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_30_Days_Before</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_30_Days_Before</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Rolling_Contract__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Pending Termination</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Owner_Active_30Days</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Today_90_Days_Before_Contract_End_Date</name>
        <label>Is Today 90 Days Before Contract End Date?</label>
        <locationX>5748</locationX>
        <locationY>384</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_90_Days_Before</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Rolling_Contract__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Pending Termination</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Owner_Active_90Days</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Key_Contact_changed</name>
        <label>Key Contact changed?</label>
        <locationX>3123</locationX>
        <locationY>3276</locationY>
        <defaultConnector>
            <targetReference>Status_changed_to_At_Risk</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Key_Contact_Changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Key_Contact__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Key_Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Notification_Type</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Does the Contract have open Commitments?</description>
        <name>Open_Commitments_Found_Check</name>
        <label>Open Commitments Found?</label>
        <locationX>3482</locationX>
        <locationY>1764</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Update_Commitments_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.No_of_In_Progress_Commitments__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.No_of_Overdue_Commitments__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Full_Term_Commitments</targetReference>
            </connector>
            <label>Yes - Update Commitments</label>
        </rules>
    </decisions>
    <decisions>
        <name>Owner_BU_New_Contract</name>
        <label>Owner BU</label>
        <locationX>974</locationX>
        <locationY>1548</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Catering_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner_Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Catering_New_Contract</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Catering_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Catering</label>
        </rules>
        <rules>
            <name>Cleaning_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cleaning</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Cleaning_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Cleaning</label>
        </rules>
        <rules>
            <name>Ireland_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Ireland</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Ireland_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Ireland</label>
        </rules>
        <rules>
            <name>Private_FM_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Private FM</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Private_FM_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Private FM</label>
        </rules>
        <rules>
            <name>Public_FM_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Public FM</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Public_FM_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Public FM</label>
        </rules>
        <rules>
            <name>Security_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner_Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Security_New_Contract</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Security_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Security</label>
        </rules>
        <rules>
            <name>Hard_Services_Projects_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Hard Services</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Hard_Services_New_Contract_Mobilisation_Notification</targetReference>
            </connector>
            <label>Hard Services &amp; Projects</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the Contract&apos;s Owner was changed then update the CLI Owner field to the new value (if the CLI Owner = Contract Owner).</description>
        <name>Owner_Changed</name>
        <label>Owner Changed?</label>
        <locationX>3123</locationX>
        <locationY>2628</locationY>
        <defaultConnector>
            <targetReference>Contract_Risk_Status_Decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Owner_Changed_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.OwnerId</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.No_of_Contract_Lines__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_CLI_Owners</targetReference>
            </connector>
            <label>Yes - Owner Changed</label>
        </rules>
    </decisions>
    <decisions>
        <description>If any of the Contract record variable values were updated then write these to the database.</description>
        <name>Record_Update_Required</name>
        <label>Record Update Required?</label>
        <locationX>3123</locationX>
        <locationY>5208</locationY>
        <defaultConnectorLabel>No - End</defaultConnectorLabel>
        <rules>
            <name>Yes_Update_Contract_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Set_Risk_Status_Amber</leftValueReference>
                <operator>WasVisited</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Set_Risk_Status_Green</leftValueReference>
                <operator>WasVisited</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Set_Risk_Status_Red</leftValueReference>
                <operator>WasVisited</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Set_Updated_Status</leftValueReference>
                <operator>WasVisited</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Contract</targetReference>
            </connector>
            <label>Yes - Update Contract</label>
        </rules>
    </decisions>
    <decisions>
        <name>Region_New_Contract</name>
        <label>Region</label>
        <locationX>1612</locationX>
        <locationY>1440</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>UKI_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner_Region__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>UK&amp;I</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Owner_BU_New_Contract</targetReference>
            </connector>
            <label>UKI</label>
        </rules>
        <rules>
            <name>APAC_New_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contract_Region__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>APAC</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Terminated</targetReference>
            </connector>
            <label>APAC</label>
        </rules>
    </decisions>
    <decisions>
        <description>Is the Contract Start Date greater or equal to today and has at least 1 service.</description>
        <name>Send_New_Contract_Notification</name>
        <label>Send New Contract Notification</label>
        <locationX>2544</locationX>
        <locationY>1116</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contract_Start_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>$Flow.CurrentDate</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.No_of_Services__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Emails_Enabled_New_Contract_UK_I_Notification</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the Start Date is changed then update the new start date on any Contract Line Items that Start on the Prior Contract Start Date.</description>
        <name>Start_Date_Changed_Decision</name>
        <label>Start Date Changed?</label>
        <locationX>3482</locationX>
        <locationY>1416</locationY>
        <defaultConnector>
            <targetReference>Open_Commitments_Found_Check</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Continue</defaultConnectorLabel>
        <rules>
            <name>Yes_Update_Line_Start_Dates_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contract_Start_Date__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_CLI_Start_Dates</targetReference>
            </connector>
            <label>Yes - Update Line Start Dates</label>
        </rules>
    </decisions>
    <decisions>
        <description>Were the Contract Start or End Dates changed? If so then consider amending the dates on the Open Full-Term commitments.</description>
        <name>Start_End_Dates_Changed_Decision</name>
        <label>Start/End Dates Changed?</label>
        <locationX>3702</locationX>
        <locationY>1308</locationY>
        <defaultConnector>
            <targetReference>Contract_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Dates_Changed_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contract_Start_Date__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contract_End_Date__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Start_Date_Changed_Decision</targetReference>
            </connector>
            <label>Yes - Dates Changed</label>
        </rules>
    </decisions>
    <decisions>
        <description>NOTE: Update of Account Contract Status to At Risk is handled above within the Customer Type/Account Contract Status section</description>
        <name>Status_changed_to_At_Risk</name>
        <label>Status changed to At Risk?</label>
        <locationX>3123</locationX>
        <locationY>3792</locationY>
        <defaultConnector>
            <targetReference>Status_Changed_to_Terminated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Status_At_Risk</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>At Risk</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Rolling_Contract__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Emails_Enabled_At_Risk_Notifications</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Status_Changed_to_Terminated</name>
        <label>Status Changed to Terminated?</label>
        <locationX>3123</locationX>
        <locationY>4668</locationY>
        <defaultConnector>
            <targetReference>Record_Update_Required</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Terminated_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Terminated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Commitments_Exist_Decision</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Yes - Terminated</label>
        </rules>
    </decisions>
    <decisions>
        <description>Did the Subflow update the Contract&apos;s Status? If so then update the Global Record Var of this flow accordingly via an Assignment variable.</description>
        <name>Status_Updated</name>
        <label>Status Updated?</label>
        <locationX>3123</locationX>
        <locationY>600</locationY>
        <defaultConnector>
            <targetReference>Create_or_Update</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Continue</defaultConnectorLabel>
        <rules>
            <name>Yes_StatusUpdated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Contract_Status_Subflow.v_Status_Updated</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Updated_Status</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check that BOTH Flows and Emails are NOT disabled</description>
        <name>Validate_Config_Switch</name>
        <label>Validate Config Switch</label>
        <locationX>4923</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Enabled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Flows_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Today_30_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Enabled</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check that BOTH Flows and Emails are NOT disabled</description>
        <name>Validate_Config_Switch_1</name>
        <label>Validate Config Switch</label>
        <locationX>5979</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Enabled_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Flows_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Today_90_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Enabled</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check that BOTH Flows and Emails are NOT disabled</description>
        <name>Validate_Config_Switch_2</name>
        <label>Validate Config Switch</label>
        <locationX>7035</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Enabled_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Flows_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Today_180_Days_Before_Contract_End_Date</targetReference>
            </connector>
            <label>Enabled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Validate_Config_Switch_3</name>
        <label>Validate Config Switch</label>
        <locationX>3610</locationX>
        <locationY>276</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Enabled_3</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Flows_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_is_New</targetReference>
            </connector>
            <label>Enabled</label>
        </rules>
    </decisions>
    <description>Contract: After Create and Update including contract end notifications
Add Contract Name</description>
    <environments>Default</environments>
    <formulas>
        <name>f_isNew</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c}, {!$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c}, ISNEW())</expression>
    </formulas>
    <formulas>
        <name>Is_180_Days_Before</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Record.Contract_End_Date__c} - {!$Flow.CurrentDate} = 180, True, False)</expression>
    </formulas>
    <formulas>
        <name>Is_30_Days_Before</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Record.Contract_End_Date__c} - {!$Flow.CurrentDate} = 30, True, False)</expression>
    </formulas>
    <formulas>
        <name>Is_90_Days_Before</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Record.Contract_End_Date__c} - {!$Flow.CurrentDate} = 90, True, False)</expression>
    </formulas>
    <interviewLabel>Contract: After Create and Update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Contract: After Create and Update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Notification_Type</name>
        <label>Get Notification Type</label>
        <locationX>2991</locationX>
        <locationY>3384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Account_Team_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Key_Contact_Changed_on_Contract</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CustomNotificationType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Close_Commitments</name>
        <label>Close Commitments</label>
        <locationX>2639</locationX>
        <locationY>4884</locationY>
        <connector>
            <targetReference>Record_Update_Required</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Complete</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Completion_Date__c</field>
            <value>
                <elementReference>$Record.Termination_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Complete</stringValue>
            </value>
        </inputAssignments>
        <object>Commitment__c</object>
    </recordUpdates>
    <recordUpdates>
        <description>Terminate CLIs. CLI Before Save flow will set Active at Termination checkbox as required.</description>
        <name>Terminate_CLIs</name>
        <label>Terminate CLIs</label>
        <locationX>2859</locationX>
        <locationY>2388</locationY>
        <connector>
            <targetReference>Owner_Changed</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Terminated</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Line_Termination_Date__c</field>
            <value>
                <elementReference>$Record.Termination_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Termination_Reason__c</field>
            <value>
                <elementReference>$Record.Termination_Reason__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_Line_Item__c</object>
    </recordUpdates>
    <recordUpdates>
        <description>Where the CLI Owner = the previous Contract Owner update the Owner to the new value</description>
        <name>Update_CLI_Owners</name>
        <label>Update CLI Owners</label>
        <locationX>2859</locationX>
        <locationY>2736</locationY>
        <connector>
            <targetReference>Contract_Risk_Status_Decision</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>1 AND 2 AND (3 OR 4)</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Terminated</stringValue>
            </value>
        </filters>
        <filters>
            <field>Owner__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record__Prior.OwnerId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Owner__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Owner__c</field>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_Line_Item__c</object>
    </recordUpdates>
    <recordUpdates>
        <description>Where the Contract Start Date has been changed update any CLIs that started on the prior start date with the new start date.</description>
        <name>Update_CLI_Start_Dates</name>
        <label>Update CLI Start Dates</label>
        <locationX>3218</locationX>
        <locationY>1524</locationY>
        <connector>
            <targetReference>Open_Commitments_Found_Check</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Start_Date__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record__Prior.Contract_Start_Date__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Line_Termination_Date__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Start_Date__c</field>
            <value>
                <elementReference>$Record.Contract_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_Line_Item__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract</name>
        <label>Update Contract</label>
        <locationX>2859</locationX>
        <locationY>5316</locationY>
        <faultConnector>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Update Commitments with Type = Full-Term to align Start Date and Due Date with Contract Start and Contract End.</description>
        <name>Update_Full_Term_Commitments</name>
        <label>Update Full-Term Commitments</label>
        <locationX>3218</locationX>
        <locationY>1872</locationY>
        <connector>
            <targetReference>Contract_Terminated</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Full-Term</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Due_Date__c</field>
            <value>
                <elementReference>$Record.Contract_End_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Start_Date__c</field>
            <value>
                <elementReference>$Record.Contract_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <object>Commitment__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Related_Opportunity_New_Contract</name>
        <label>Update Related Opportunity</label>
        <locationX>2544</locationX>
        <locationY>1008</locationY>
        <connector>
            <targetReference>Send_New_Contract_Notification</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Opportunity__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contract__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Contract__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <start>
        <locationX>5196</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Validate_Config_Switch_3</targetReference>
        </connector>
        <object>Contract__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <scheduledPaths>
            <name>X30_Days_before_Contract_End_Date</name>
            <connector>
                <targetReference>Validate_Config_Switch</targetReference>
            </connector>
            <label>30 Days before Contract End Date</label>
            <offsetNumber>-30</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>Contract_End_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <scheduledPaths>
            <name>X90_Days_before_Contract_End_Date</name>
            <connector>
                <targetReference>Validate_Config_Switch_1</targetReference>
            </connector>
            <label>90 Days before Contract End Date</label>
            <offsetNumber>-90</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>Contract_End_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <scheduledPaths>
            <name>X180_Days_before_Contract_End_Date</name>
            <connector>
                <targetReference>Validate_Config_Switch_2</targetReference>
            </connector>
            <label>180 Days before Contract End Date</label>
            <offsetNumber>-180</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>Contract_End_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <subflows>
        <name>Contract_Status_Subflow</name>
        <label>Contract: Status Subflow</label>
        <locationX>3123</locationX>
        <locationY>492</locationY>
        <connector>
            <targetReference>Status_Updated</targetReference>
        </connector>
        <flowName>Contract_Status_Subflow</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Log_Error</name>
        <label>Log Error</label>
        <locationX>3123</locationX>
        <locationY>5424</locationY>
        <flowName>Utility_Error_Log_Creation</flowName>
        <inputAssignments>
            <name>Level</name>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Messages</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Object</name>
            <value>
                <stringValue>Contract</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>OriginName</name>
            <value>
                <stringValue>Contract: After Create and Update</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>RecordId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Type</name>
            <value>
                <stringValue>Flow</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <name>currentItem_At_Risk_Account_Contracts</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Expired_Account_Contracts</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract__c</objectType>
    </variables>
    <variables>
        <name>Recipients_ID</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>v_Count_AtRisk_AccountContracts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>v_Count_Expired_AccountContracts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>v_isNew</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
