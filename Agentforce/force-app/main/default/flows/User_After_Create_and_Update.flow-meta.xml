<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Create_New_User_Onboarding_Fed_ID</name>
        <label>Create - New User Onboarding - Fed ID</label>
        <locationX>787</locationX>
        <locationY>1619</locationY>
        <actionName>User.User_Onboarding_Welcome_Email_With_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Onboarding_Email_Sent_Date_SSO_Create</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Onboarding_Welcome_Email_With_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Create_New_User_Onboarding_MFA</name>
        <label>Create - New User Onboarding - MFA</label>
        <locationX>1315</locationX>
        <locationY>1619</locationY>
        <actionName>User.User_Onboarding_Welcome_Email_Without_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Onboarding_Email_Sent_Date_MFA_Create</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Onboarding_Welcome_Email_Without_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Reactivated_Welcome_Email_MFA</name>
        <label>Send Reactivated Welcome Email - MFA</label>
        <locationX>6023</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Reactivated_Welcome_Email_Without_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Reactivated_Welcome_Email_Without_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_Reactivated_Welcome_Email_SSO</name>
        <label>Send Reactivated Welcome Email - SSO</label>
        <locationX>5759</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Reactivated_Welcome_Email_With_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Reactivated_Welcome_Email_With_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_User_Deactivation_Email_MFA</name>
        <label>Send User Deactivation Email - MFA</label>
        <locationX>4967</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Off_Boarding_Email_Without_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Off_Boarding_Email_Without_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Send_User_Deactivation_Email_SSO</name>
        <label>Send User Deactivation Email - SSO</label>
        <locationX>4703</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Off_Boarding_Email_With_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Off_Boarding_Email_With_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Update_New_User_Onboarding_MFA</name>
        <label>Update - New User Onboarding - MFA</label>
        <locationX>3383</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Onboarding_Welcome_Email_Without_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Onboarding_Email_Sent_Date_MFA_Update</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Onboarding_Welcome_Email_Without_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Update_New_User_Onboarding_SSO</name>
        <label>Update - New User Onboarding - SSO</label>
        <locationX>2855</locationX>
        <locationY>1487</locationY>
        <actionName>User.User_Onboarding_Welcome_Email_With_Fed_Id</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Update_Onboarding_Email_Sent_Date_SSO_Update</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>User.User_Onboarding_Welcome_Email_With_Fed_Id</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>58.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Set_is_New_Variable</name>
        <label>Set is New Variable</label>
        <locationX>3131</locationX>
        <locationY>431</locationY>
        <assignmentItems>
            <assignToReference>V_isNew</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_isNew</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_or_Update</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Business_Unit_and_Corporate_Type_Set</name>
        <label>Business Unit and Corporate Type Set?</label>
        <locationX>710</locationX>
        <locationY>2483</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Fields_Set</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Corporate_Type__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Business_Unit__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Matching_Group</targetReference>
            </connector>
            <label>Fields Set</label>
        </rules>
    </decisions>
    <decisions>
        <name>Create_or_Update</name>
        <label>Create or Update?</label>
        <locationX>3131</locationX>
        <locationY>539</locationY>
        <defaultConnector>
            <targetReference>Profile_or_Country_Changed_Decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Update</defaultConnectorLabel>
        <rules>
            <name>Create</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>V_isNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Federation_ID_Populated_Decision</targetReference>
            </connector>
            <label>Create</label>
        </rules>
    </decisions>
    <decisions>
        <name>De_Activated_User_Type</name>
        <label>De-Activated User Type</label>
        <locationX>4835</locationX>
        <locationY>1379</locationY>
        <defaultConnector>
            <targetReference>Send_User_Deactivation_Email_MFA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>MFA</defaultConnectorLabel>
        <rules>
            <name>Off_Boarding_Fed_ID_Populated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>NotEqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Send_User_Deactivation_Email_SSO</targetReference>
            </connector>
            <label>SSO</label>
        </rules>
    </decisions>
    <decisions>
        <name>Determine_Onboarding_Email_Identity_User</name>
        <label>Determine Onboarding Email</label>
        <locationX>3119</locationX>
        <locationY>1379</locationY>
        <defaultConnector>
            <targetReference>Update_New_User_Onboarding_MFA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Fed ID Empty</defaultConnectorLabel>
        <rules>
            <name>On_Boarding_Fed_ID_Populated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_New_User_Onboarding_SSO</targetReference>
            </connector>
            <label>Fed ID Populated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Determine_Onboarding_Email_Reactivated</name>
        <label>Determine Onboarding Email</label>
        <locationX>5891</locationX>
        <locationY>1379</locationY>
        <defaultConnector>
            <targetReference>Send_Reactivated_Welcome_Email_MFA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Fed ID Empty</defaultConnectorLabel>
        <rules>
            <name>Fed_ID_Populated_Reactivated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Reactivated_Welcome_Email_SSO</targetReference>
            </connector>
            <label>Fed ID Populated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_Deactivation_Notification_Decision</name>
        <label>Emails Enabled? (Deactivation Notification)</label>
        <locationX>5033</locationX>
        <locationY>1271</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Emails_Enabled_Deactivation_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>De_Activated_User_Type</targetReference>
            </connector>
            <label>Yes - Continue</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_Onboarding_Email_Decision</name>
        <label>Emails Enabled? (Onboarding Email)</label>
        <locationX>1667</locationX>
        <locationY>1403</locationY>
        <defaultConnector>
            <targetReference>FieldsPopulated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Emails_Enabled_Creation_Onboarding_Email_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Onboarding_Email_Create</targetReference>
            </connector>
            <label>Yes - Continue</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_Onboarding_Notification_Decision</name>
        <label>Emails Enabled? (Onboarding Notification)</label>
        <locationX>3515</locationX>
        <locationY>1271</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Emails_Enabled_Onboarding_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Determine_Onboarding_Email_Identity_User</targetReference>
            </connector>
            <label>Yes - Continue</label>
        </rules>
    </decisions>
    <decisions>
        <name>Emails_Enabled_Reactivation_Notification_Decision</name>
        <label>Emails Enabled? (Reactivation Notification)</label>
        <locationX>6089</locationX>
        <locationY>1271</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Emails_Enabled_Reactivation_Notification_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Emails_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Determine_Onboarding_Email_Reactivated</targetReference>
            </connector>
            <label>Yes - Continue</label>
        </rules>
    </decisions>
    <decisions>
        <description>If Federation ID field is filled on user creation then assign the &apos;Auth - Enforce SSO&apos; permission set to force this user to login via SSO only.</description>
        <name>Federation_ID_Populated_Decision</name>
        <label>Federation ID Populated?</label>
        <locationX>1667</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Get_Authentication_Enforce_MFA_Permission_Set</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Continue</defaultConnectorLabel>
        <rules>
            <name>Yes_Enforce_SSO</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Enforce_SSO_Permission_Set_Creation</targetReference>
            </connector>
            <label>Yes - Enforce SSO</label>
        </rules>
    </decisions>
    <decisions>
        <name>FieldsPopulated</name>
        <label>FieldsPopulated</label>
        <locationX>1667</locationX>
        <locationY>2051</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CorporateType_Country</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Corporate_Type__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Country</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>getGroup</targetReference>
            </connector>
            <label>CorporateType&amp;Country</label>
        </rules>
    </decisions>
    <decisions>
        <name>GetNull</name>
        <label>GetNull</label>
        <locationX>1172</locationX>
        <locationY>2267</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>NullGet</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getGroup.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CreateGroup</targetReference>
            </connector>
            <label>NullGet</label>
        </rules>
    </decisions>
    <decisions>
        <name>Group_Found</name>
        <label>Group Found?</label>
        <locationX>314</locationX>
        <locationY>2699</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Matching_Group_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Matching_Group.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Group_Member</targetReference>
            </connector>
            <label>Matching Group Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_New_User_from_AD</name>
        <label>Is New User from AD?</label>
        <locationX>4595</locationX>
        <locationY>947</locationY>
        <defaultConnector>
            <targetReference>User_Changed_to_De_activated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>New_Changed_from_Identity_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Profile.Name</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Profile.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Identity User</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LastLoginDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Enforce_SSO_Permission_Set_Update</targetReference>
            </connector>
            <label>Yes - Changed from Identity User</label>
        </rules>
    </decisions>
    <decisions>
        <description>If a Salesforce Licence (not Platform) is assigned then trigger the Opportunity Record Type Assignment Subflow to assign the correct Record Type to the User.</description>
        <name>Licence_Type_Decision_Creation</name>
        <label>Licence Type Decision (Creation)</label>
        <locationX>1667</locationX>
        <locationY>1103</locationY>
        <defaultConnector>
            <targetReference>Emails_Enabled_Onboarding_Email_Decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other - Skip</defaultConnectorLabel>
        <rules>
            <name>Salesforce_Licence_Outcome_Creation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Licence_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Salesforce</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity_Record_Type_Permission_Assignment_Subflow_Creation</targetReference>
            </connector>
            <label>Salesforce</label>
        </rules>
    </decisions>
    <decisions>
        <description>If either the user&apos;s profile is changed or their country is changed then trigger the Opportunity Record Type Permission Assignment Subflow.
Only do this where either the current Licence is Salesforce or the prior Licence was Salesforce. Otherwise skip.</description>
        <name>Profile_or_Country_Changed_Decision</name>
        <label>Profile or Country Changed?</label>
        <locationX>4595</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Is_New_User_from_AD</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Yes_Trigger_Opp_Record_Type_Subflow_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ProfileId</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Country</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity_Record_Type_Permission_Assignment_Subflow_Update</targetReference>
            </connector>
            <label>Yes - Trigger Subflow</label>
        </rules>
    </decisions>
    <decisions>
        <name>Send_Onboarding_Email_Create</name>
        <label>Send Onboarding Email</label>
        <locationX>1315</locationX>
        <locationY>1511</locationY>
        <defaultConnector>
            <targetReference>FieldsPopulated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Met</defaultConnectorLabel>
        <rules>
            <name>SSO_Onboarding_Email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Profile.Name</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Identity User</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LastLoginDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_New_User_Onboarding_Fed_ID</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>SSO Onboarding Email</label>
        </rules>
        <rules>
            <name>MFA_Onboarding_Email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FederationIdentifier</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Profile.Name</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Identity User</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LastLoginDate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_New_User_Onboarding_MFA</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>MFA Onboarding Email</label>
        </rules>
    </decisions>
    <decisions>
        <name>User_Changed_to_Activated</name>
        <label>User Changed to Activated?</label>
        <locationX>6320</locationX>
        <locationY>1163</locationY>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>Re_activated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Profile.Name</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Identity User</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Emails_Enabled_Reactivation_Notification_Decision</targetReference>
            </connector>
            <label>Re-activated</label>
        </rules>
    </decisions>
    <decisions>
        <name>User_Changed_to_De_activated</name>
        <label>User Dectivated?</label>
        <locationX>5676</locationX>
        <locationY>1055</locationY>
        <defaultConnector>
            <targetReference>User_Changed_to_Activated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Skip</defaultConnectorLabel>
        <rules>
            <name>User_is_Now_De_Activated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Off_Boarding_Date</targetReference>
            </connector>
            <label>User is Now De-Activated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Validate_Config_Switch</name>
        <label>Validate Config Switch</label>
        <locationX>4973</locationX>
        <locationY>323</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Enabled</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Flows_Disabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_is_New_Variable</targetReference>
            </connector>
            <label>Enabled</label>
        </rules>
    </decisions>
    <description>With Welcome Email added</description>
    <environments>Default</environments>
    <formulas>
        <name>f_businessUnit</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE(TEXT({!$Record.Business_Unit__c}), &apos; &apos;, &apos;&apos;)</expression>
    </formulas>
    <formulas>
        <name>f_businessUnitGroup</name>
        <dataType>String</dataType>
        <expression>TEXT({!$Record.Corporate_Type__c}) + &apos;_&apos; + &apos;BU_&apos; + {!f_businessUnit}</expression>
    </formulas>
    <formulas>
        <name>f_country</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE({!$Record.Country}, &apos; &apos; , &apos;_&apos;)</expression>
    </formulas>
    <formulas>
        <name>f_isNew</name>
        <dataType>Boolean</dataType>
        <expression>IF({!$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c}, {!$Setup.OCS_Config_Settings_CSH__c.Migration_Flows_Enabled__c}, ISNEW())</expression>
    </formulas>
    <formulas>
        <name>GroupName</name>
        <dataType>String</dataType>
        <expression>TEXT({!$Record.Corporate_Type__c})&amp;&quot;_&quot;&amp;{!f_country}</expression>
    </formulas>
    <interviewLabel>User: After Create and Update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>User: After Create and Update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Assign_Enforce_MFA_Permission_Set</name>
        <label>Assign Enforce MFA Permission Set</label>
        <locationX>2063</locationX>
        <locationY>863</locationY>
        <connector>
            <targetReference>Licence_Type_Decision_Creation</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AssigneeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>PermissionSetId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Authentication_Enforce_MFA_Permission_Set.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AssigneeId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PermissionSetId</field>
            <value>
                <elementReference>Get_Authentication_Enforce_MFA_Permission_Set.Id</elementReference>
            </value>
        </inputAssignments>
        <object>PermissionSetAssignment</object>
        <operationMultMatchingRecords>None</operationMultMatchingRecords>
        <operationOneMatchingRecord>None</operationOneMatchingRecord>
        <operationZeroMatchingRecords>AddRecord</operationZeroMatchingRecords>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Assign_Enforce_SSO_Permission_Set_Creation</name>
        <label>Assign Enforce SSO Permission Set</label>
        <locationX>1271</locationX>
        <locationY>863</locationY>
        <connector>
            <targetReference>Licence_Type_Decision_Creation</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>PermissionSetId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Enforce_SSO_Permission_Set_Creation.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>AssigneeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AssigneeId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PermissionSetId</field>
            <value>
                <elementReference>Get_Enforce_SSO_Permission_Set_Creation.Id</elementReference>
            </value>
        </inputAssignments>
        <object>PermissionSetAssignment</object>
        <operationMultMatchingRecords>None</operationMultMatchingRecords>
        <operationOneMatchingRecord>None</operationOneMatchingRecord>
        <operationZeroMatchingRecords>AddRecord</operationZeroMatchingRecords>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Assign_Enforce_SSO_Permission_Set_Update</name>
        <label>Assign Enforce SSO Permission Set</label>
        <locationX>3515</locationX>
        <locationY>1163</locationY>
        <connector>
            <targetReference>Emails_Enabled_Onboarding_Notification_Decision</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AssigneeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>PermissionSetId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Enforce_SSO_Permission_Set_Update.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AssigneeId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PermissionSetId</field>
            <value>
                <elementReference>Get_Enforce_SSO_Permission_Set_Update.Id</elementReference>
            </value>
        </inputAssignments>
        <object>PermissionSetAssignment</object>
        <operationMultMatchingRecords>None</operationMultMatchingRecords>
        <operationOneMatchingRecord>None</operationOneMatchingRecord>
        <operationZeroMatchingRecords>AddRecord</operationZeroMatchingRecords>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Group_Member</name>
        <label>Create Group Member</label>
        <locationX>50</locationX>
        <locationY>2807</locationY>
        <faultConnector>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>GroupId</field>
            <value>
                <elementReference>Get_Matching_Group.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>GroupMember</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>CreateGroup</name>
        <label>CreateGroup</label>
        <locationX>710</locationX>
        <locationY>2375</locationY>
        <connector>
            <targetReference>Business_Unit_and_Corporate_Type_Set</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>GroupId</field>
            <value>
                <elementReference>getGroup.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>GroupMember</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Authentication_Enforce_MFA_Permission_Set</name>
        <label>Get Authentication Enforce MFA Permission Set</label>
        <locationX>2063</locationX>
        <locationY>755</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Enforce_MFA_Permission_Set</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Authentication_Enforce_MFA</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>PermissionSet</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Enforce_SSO_Permission_Set_Creation</name>
        <label>Get Enforce SSO Permission Set</label>
        <locationX>1271</locationX>
        <locationY>755</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Enforce_SSO_Permission_Set_Creation</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Authentication_Enforce_SSO</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>PermissionSet</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Enforce_SSO_Permission_Set_Update</name>
        <label>Get Enforce SSO Permission Set</label>
        <locationX>3515</locationX>
        <locationY>1055</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Enforce_SSO_Permission_Set_Update</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Authentication_Enforce_SSO</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>PermissionSet</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Matching_Group</name>
        <label>Get Matching Group</label>
        <locationX>314</locationX>
        <locationY>2591</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Group_Found</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>f_businessUnitGroup</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getGroup</name>
        <label>getGroup</label>
        <locationX>1172</locationX>
        <locationY>2159</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>GetNull</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Regular</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GroupName</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Off_Boarding_Date</name>
        <label>Update Off-Boarding Date</label>
        <locationX>5033</locationX>
        <locationY>1163</locationY>
        <connector>
            <targetReference>Emails_Enabled_Deactivation_Notification_Decision</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Offboarding_Date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Onboarding_Email_Sent_Date_MFA_Create</name>
        <label>Update Onboarding Email Sent Date</label>
        <locationX>1315</locationX>
        <locationY>1727</locationY>
        <connector>
            <targetReference>FieldsPopulated</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Onboarding_Email_Sent__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Onboarding_Email_Sent_Date_MFA_Update</name>
        <label>Update Onboarding Email Sent Date</label>
        <locationX>3383</locationX>
        <locationY>1595</locationY>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Onboarding_Email_Sent__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Onboarding_Email_Sent_Date_SSO_Create</name>
        <label>Update Onboarding Email Sent Date</label>
        <locationX>787</locationX>
        <locationY>1727</locationY>
        <connector>
            <targetReference>FieldsPopulated</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Onboarding_Email_Sent__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Onboarding_Email_Sent_Date_SSO_Update</name>
        <label>Update Onboarding Email Sent Date</label>
        <locationX>2855</locationX>
        <locationY>1595</locationY>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Onboarding_Email_Sent__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>4847</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Validate_Config_Switch</targetReference>
        </connector>
        <object>User</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <subflows>
        <name>Log_Error</name>
        <label>Log Error</label>
        <locationX>314</locationX>
        <locationY>2915</locationY>
        <flowName>Utility_Error_Log_Creation</flowName>
    </subflows>
    <subflows>
        <name>Opportunity_Record_Type_Permission_Assignment_Subflow_Creation</name>
        <label>Opportunity Record Type Permission Assignment Subflow (Creation)</label>
        <locationX>1535</locationX>
        <locationY>1211</locationY>
        <connector>
            <targetReference>Emails_Enabled_Onboarding_Email_Decision</targetReference>
        </connector>
        <flowName>User_Opportunity_Record_Type_Permission_Set_Subflow</flowName>
        <inputAssignments>
            <name>vIn_User</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Opportunity_Record_Type_Permission_Assignment_Subflow_Update</name>
        <label>Opportunity Record Type Permission Assignment Subflow (Update)</label>
        <locationX>4463</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Is_New_User_from_AD</targetReference>
        </connector>
        <flowName>User_Opportunity_Record_Type_Permission_Set_Subflow</flowName>
        <inputAssignments>
            <name>vIn_User</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <name>RecordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <value>
            <elementReference>$Record.Id</elementReference>
        </value>
    </variables>
    <variables>
        <name>V_isNew</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
